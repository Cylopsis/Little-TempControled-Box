<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Temperature Chamber Dashboard</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>
  <div class="header">
    <h1><i class="fas fa-thermometer-half"></i> Temperature Chamber Dashboard</h1>
    <div id="connection-status" class="connection-status"><i class="fas fa-circle disconnected"></i><span>Disconnected</span></div>
  </div>

  <div id="layout-container" class="layout-container">

    <div class="widget draggable" data-widget="thermometer">
      <div class="widget-header">
        <h2><i class="fas fa-thermometer-half"></i> Live Thermal View</h2>
        <div class="widget-controls">
          <button class="minimize-btn"><i class="fas fa-minus"></i></button>
        </div>
      </div>
      <div class="widget-content">
        <div class="thermometer-container">
          <div class="thermometer">
            <div class="thermometer-column">
              <div id="target-marker" class="thermometer-target"></div>
              <div id="temperature-fill" class="thermometer-fill">
                <div id="temperature-label" class="thermometer-label current">--°C</div>
              </div>
              <div id="target-label" class="thermometer-label target">Target --°C</div>
            </div>
            <div class="thermometer-scale">
              <span id="scale-max">80°C</span>
              <span id="scale-upper">60°C</span>
              <span id="scale-lower">40°C</span>
              <span id="scale-min">20°C</span>
            </div>
          </div>
          <div class="thermometer-legend">
            <span class="legend-item"><span class="marker current"></span>Current</span>
            <span class="legend-item"><span class="marker target"></span>Target</span>
          </div>
        </div>
      </div>
    </div>

    <div class="widget draggable" data-widget="metrics">
      <div class="widget-header">
        <h2><i class="fas fa-chart-line"></i> Real-time Metrics</h2>
        <div class="widget-controls">
          <button class="minimize-btn"><i class="fas fa-minus"></i></button>
        </div>
      </div>
      <div class="widget-content">
        <div class="grid-container">
          <div class="metric-card">
            <div class="metric-icon"><i class="fas fa-temperature-high"></i></div>
            <div class="metric-info">
              <span class="label">Current Temperature:</span>
              <span id="current_temperature" class="value">--</span>
            </div>
          </div>
          <div class="metric-card">
            <div class="metric-icon"><i class="fas fa-bullseye"></i></div>
            <div class="metric-info">
              <span class="label">Target Temperature:</span>
              <span id="target_temperature" class="value">--</span>
            </div>
          </div>
          <div class="metric-card">
            <div class="metric-icon"><i class="fas fa-tint"></i></div>
            <div class="metric-info">
              <span class="label">Current Humidity:</span>
              <span id="current_humidity" class="value">--</span>
            </div>
          </div>
          <div class="metric-card">
            <div class="metric-icon"><i class="fas fa-thermometer-empty"></i></div>
            <div class="metric-info">
              <span class="label">Environment Temperature:</span>
              <span id="env_temperature" class="value">--</span>
            </div>
          </div>
          <div class="metric-card">
            <div class="metric-icon"><i class="fas fa-fire"></i></div>
            <div class="metric-info">
              <span class="label">PTC Heater:</span>
              <span id="ptc_state" class="value">--</span>
            </div>
          </div>
          <div class="metric-card">
            <div class="metric-icon"><i class="fas fa-fire"></i></div>
            <div class="metric-info">
              <span class="label">Bottom Heater:</span>
              <span id="btm_ptc_state" class="value">--</span>
            </div>
          </div>
          <div class="metric-card">
            <div class="metric-icon"><i class="fas fa-stream"></i></div>
            <div class="metric-info">
              <span class="label">Control State:</span>
              <span id="control_state" class="value">--</span>
            </div>
          </div>
          <div class="metric-card">
            <div class="metric-icon"><i class="fas fa-fan"></i></div>
            <div class="metric-info">
              <span class="label">Fan Output (%):</span>
              <span id="fan_speed_percent" class="value">--</span>
            </div>
          </div>
          <div class="metric-card">
            <div class="metric-icon"><i class="fas fa-fan"></i></div>
            <div class="metric-info">
              <span class="label">Fan Output (0-1):</span>
              <span id="fan_speed" class="value">--</span>
            </div>
          </div>
          <div class="metric-card">
            <div class="metric-icon"><i class="fas fa-forward"></i></div>
            <div class="metric-info">
              <span class="label">Feedforward Speed:</span>
              <span id="feedforward_speed" class="value">--</span>
            </div>
          </div>
          <div class="metric-card">
            <div class="metric-icon"><i class="fas fa-project-diagram"></i></div>
            <div class="metric-info">
              <span class="label">PID Output:</span>
              <span id="pid_output" class="value">--</span>
            </div>
          </div>
          <div class="metric-card">
            <div class="metric-icon"><i class="fas fa-equals"></i></div>
            <div class="metric-info">
              <span class="label">PID KP:</span>
              <span id="pid_kp" class="value">--</span>
            </div>
          </div>
          <div class="metric-card">
            <div class="metric-icon"><i class="fas fa-equals"></i></div>
            <div class="metric-info">
              <span class="label">PID KI:</span>
              <span id="pid_ki" class="value">--</span>
            </div>
          </div>
          <div class="metric-card">
            <div class="metric-icon"><i class="fas fa-equals"></i></div>
            <div class="metric-info">
              <span class="label">PID KD:</span>
              <span id="pid_kd" class="value">--</span>
            </div>
          </div>
          <div class="metric-card">
            <div class="metric-icon"><i class="fas fa-arrows-left-right-to-line"></i></div>
            <div class="metric-info">
              <span class="label">Integral Error:</span>
              <span id="integral_error" class="value">--</span>
            </div>
          </div>
          <div class="metric-card">
            <div class="metric-icon"><i class="fas fa-history"></i></div>
            <div class="metric-info">
              <span class="label">Previous Error:</span>
              <span id="previous_error" class="value">--</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="widget draggable" data-widget="controls">
      <div class="widget-header">
        <h2><i class="fas fa-cogs"></i> Control Panel</h2>
        <div class="widget-controls">
          <button class="minimize-btn"><i class="fas fa-minus"></i></button>
        </div>
      </div>
      <div class="widget-content">
        <div class="controls-section">
          <h3><i class="fas fa-thermometer-three-quarters"></i> Target Temperature Control</h3>
          <div class="control-group">
            <label for="target_temperature_input">Target Temperature (°C):</label>
            <input type="number" id="target_temperature_input" step="0.1" class="control-input">
            <button id="set_target_btn" class="control-button"><i class="fas fa-check"></i> Set Target</button>
          </div>
        </div>

        <div class="controls-section">
          <h3><i class="fas fa-sliders-h"></i> Manual PID Override</h3>
          <div class="control-group">
            <label for="kp_input">Kp:</label>
            <input type="number" id="kp_input" step="0.0001" class="control-input">
          </div>
          <div class="control-group">
            <label for="ki_input">Ki:</label>
            <input type="number" id="ki_input" step="0.0001" class="control-input">
          </div>
          <div class="control-group">
            <label for="kd_input">Kd:</label>
            <input type="number" id="kd_input" step="0.0001" class="control-input">
          </div>
          <button id="set_pid_btn" class="control-button"><i class="fas fa-check"></i> Set PID</button>
        </div>

        <div class="controls-section">
          <h3><i class="fas fa-table"></i> Feedforward Table</h3>
          <div class="table-container">
            <table id="ff_table">
              <thead>
                <tr>
                  <th>Index</th>
                  <th>Temperature (°C)</th>
                  <th>Base Speed</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody id="ff_table_body">
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

  </div>

  <script src="script.js"></script>
</body>
</html>